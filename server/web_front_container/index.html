<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="style.css">
    <title>GG Store</title>
</head>
<body>

    <div class="overlay1" id="overlay"></div>

    <nav>
        <div class="logo-container">
            <a class="logo">GG Store</a>
        </div>
    </nav>

    <h2 class="separator">
        Аренда аккаунтов
    </h2>

    <section class="games-list">
        <div class="item">
            <img src="src/Pack 1.jpg">
            <div class="info">
                Zelda TOTK
            </div>
            <div class="price">
                400 ₽
            </div>
        </div>

        <div class="item">
            <img src="src/Pack 1.jpg">
            <div class="info">
                Mario
            </div>
            <div class="price">
                400 ₽
            </div>
        </div>

        <div class="item">
            <img src="src/Pack 1.jpg">
            <div class="info">
                Top 10 Games
            </div>
            <div class="price">
                600 ₽
            </div>
        </div>

        <div class="item">
            <img src="src/Pack 1.jpg">
            <div class="info">
                Witcher
            </div>
            <div class="price">
                400 ₽
            </div>
        </div>

        <div class="item">
            <img src="src/Pack 1.jpg">
            <div class="info">
                Animal Crossing
            </div>
            <div class="price">
                500 ₽
            </div>
        </div>
        
    </section>


    <h2 class="separator">
        Подписки
    </h2>
    

    <div class="code">
        <img src="src/Nonline.png">
        <div class="info">
            Nintendo Online
        </div>
    </div>

    <div class="code">
        <img src="src/psplus.jpg">
        <div class="info">
            Paystation Plus
        </div>
    </div>    

    <h2 class="separator">
        Коды оплаты
    </h2>

    <div class="code">
        <img src="src/eshop.jpg">
        <div class="info">
            eShop
        </div>
    </div>

    <div class="code" onclick="javascript:psnPopupShow()">
        <img src="src/psn.jpeg">
        <div class="info">
            PSN
        </div>
    </div>  

    <div class="code">
        <img src="src/steam.jpg">
        <div class="info">
            Steam
        </div>
    </div>  

    <div class="popupWindowWrapper" id="popupPSPLUS">
        <p>
            <div class="popupWindow">
                <button class="closebutton" onclick="javascript:psnPopupHide()"></button>
                <img src="src/psplus.png">
                <h2>PS Plus Premium</h2>

                <div class="description">
                    <label for="name">Расширенная подписка для PlayStation. В неё входит всё, что есть в PS Plus Essential, а ещё она откроет каталог с сотнями консольных хитов (будто Game Pass от Xbox).</label>
                </div>

                <button class="form-control">
                    <label for="name">1 месяц</label>
                </button>

                <button class="form-control">
                    <label for="email">3 месяца</label>
                </button>

                <button class="form-control">
                    <label for="phone">12 месяцев</label>
                </button>

                <button class="form-control2" type="submit" id="PSPLUSBUY">КУПИТЬ</button>
        </div>
        </p>
    </div>


    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <script>
        let tg = window.Telegram.WebApp; //получаем объект webapp телеграма 

        tg.expand(); //расширяем на все окно

        psPlusBuyButton = document.getElementById("PSPLUSBUY");

        psPlusBuyButton.addEventListener('click', function(){
            // send some string back
            alert("button clicked");
            alert(`WHOA HELLOW MR. ${tg.initDataUnsafe.user.first_name}, your id is: ${tg.initDataUnsafe.user.id}`);
            alert("starting fetch");

            $.ajax({
            url: 'http://37.193.60.52:9999/request',
            method: 'POST',
            contentType: 'application/json',
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            data: JSON.stringify({
                "type": 'buy',
                user_id: tg.initDataUnsafe.user.id,
            }),
            success: function(response) {
                alert(response);
            },
            error: function(error) {
                alert(error);
            }
        });

        });

    </script>

    <script src="http://code.jquery.com/jquery-2.0.2.min.js"></script>
    <script>
    $(document).ready(function(){   
        psnPopupHide();
        function hasTouch() {
    return 'ontouchstart' in document.documentElement
            || navigator.maxTouchPoints > 0
            || navigator.msMaxTouchPoints > 0;
    }

    if (hasTouch()) {
    try {
        for (var si in document.styleSheets) {
        var styleSheet = document.styleSheets[si];
        if (!styleSheet.rules) continue;

        for (var ri = styleSheet.rules.length - 1; ri >= 0; ri--) {
            if (!styleSheet.rules[ri].selectorText) continue;

            if (styleSheet.rules[ri].selectorText.match(':hover')) {
            styleSheet.deleteRule(ri);
            }
        }
        }
    } catch (ex) {}
    }
            });
            function psnPopupShow(){
                $("#popupPSPLUS").show();
                $("#overlay").show();
            }
            function psnPopupHide(){
                $("#popupPSPLUS").hide();
                $("#overlay").hide();
            }
    </script>


</body>
</html>